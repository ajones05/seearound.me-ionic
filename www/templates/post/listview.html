<ion-view hide-nav-bar="true" hide-back-button="true" class="postlistview">
    <div class="bar bar-header">
        <div class="row" style="padding-top:10px">
            <button menu-toggle="left" class="button button-icon">
                <img src="img/menu_off.png" height="22"/>
            </button>
            <button class="col button button-icon" style="margin-left:18px" ui-sref="newpostview">
                <img src="img/newpost_off.png" height="24"/>
            </button>
            <button class="col button button-icon" ng-click="showAlerts($event)" >
                <img src="img/alerts_off.png" height="24"/>
            </button>
            <button class="col button button-icon" style="margin-right:18px" ng-click="toggleSearch()">
                <img ng-show="!isFiltered" src="img/search_off.png" height="24"/>
                <img ng-show="isFiltered" src="img/search_on.png" height="24"/>
            </button>
            <button class="button button-icon" ui-sref="app.postmapview">
              <img src="img/map_off.png" height="28"/>
            </button>
        </div>
    </div>
    <div class="row bar bar-subheader" style="background:#eee;" ng-show="showSearch">
        <div class="col" style="margin-left:-5px;">
            <div class="row" style="border:2px solid #ddd;height:100%;background:#fff;">
        <i class="icon ion-ios-search" style="font-size:1.4em;padding-right:10px;margin:0;"></i>
                <input type="text" name="searchTerm" ng-model="searchTerm" placeholder="Search ..." style="width:100%;height:100%;background:#fff;">
            </div>
         </div>
        <div style="margin-right:5px;width:100px;">    
            <div class="item item-icon-right" style="border:2px solid #ddd;" ng-click="showSelect($event)">
                <label class="post-select">
                  {{selected.label}}
                  <i style="margin-right:-10px;font-size:1.5em;" class="icon ion-ios-arrow-down"></i>
                </label>             
            </div>
        </div>
        <div class="col-20">            
          <button class="button button-block button-positive" ng-show="!isFiltered" ng-click="searchPosts()">Go</button>
          <button class="button button-block button-positive" ng-show="isFiltered" ng-click="clearSearch()">Cancel</button>
        </div>
    </div>          
  <ion-content padding="false" class="has-header">
      
    <div class="post_item" ng-repeat='post in nearbyPosts track by $index' >
      <div class="row user">
        <div class="col col-20 avatar"
          ng-click="goToProfile(post.user_id)"
          >
          <img ng-src={{post.Profile_image}}>
        </div>
        <div class="col"> 
          <div class="name">
            <span>{{post.Name}}</span>
            <div class="date">
              {{post.timeAgo}}
            </div>
          </div>
            <!--p class="desc" ng-bind-html="post.news | linky | hrefToJS"></p-->
            <p class="desc">{{post.news}}</p>
        </div>
        <div 
          ng-click="showMapForPost(post.latitude, post.longitude)"
          style="width:20px;padding-top:1%">
          <a class="icon ion-ios-location-outline" style="font-size:1.3em;"></a>
        </div>
      </div>
      <img ng-if="post.images" class="post-iamge" ng-src={{post.images}} alt="">
        <div class="item" style="padding-top:0;" ng-if="post.link_url" ng-click="openLink(post.link_url)">
            <div class="item-body">
              <img class="full-image" ng-src={{post.link_image}} ng-if="post.link_image" alt="">
              <div class="post-link">
                  <h3 class="link-title">{{post.link_title}}</h3>
                  <span class="link-text">{{post.link_description}}</span>
              </div>
            </div>
        </div>
      <div class="share row">
        <span class="col col-20 chat-bubble" ng-click="goToComments(post)">
          {{post.comment_count}}
          <img src="img/chat.png" alt="">
        </span>
        <post-like-box></post-like-box>
        <span class="col" ng-click='openShare(post.news, post.link_url)'> Share</span>
      </div>
    </div>
    <ion-infinite-scroll ng-if="hasMore" on-infinite="loadMore()" distance="1%">
        Load more posts
  </ion-infinite-scroll>
  </ion-content>
</ion-view>
