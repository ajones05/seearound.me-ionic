<ion-view hide-nav-bar="true" hide-back-button="true" class="postlistview">
    <div class="bar bar-header bar-positive">
          <button ui-sref="app.filters" class="button button-clear" style="margin-right:10px;">
            Filter
          </button>        
          <div class="row item-input-wrapper" style="background:#fff;height:32px;">
              <i class="icon ion-ios-search" style="font-size:1.4em;color:#666;"></i>
              <form style="width:90%;" name="searchForm" ng-submit="searchPosts()">                
                <input type="search" 
                       name="searchTerm" 
                       ng-model="searchTerm" 
                       placeholder="Keyword Search..."
                       ng-focus="searchMode=true;"
                       style="width:100%;height:100%;background:#fff;">
              </form>
            <a ng-show="isFiltered" style="width:10%;" ng-click="clearSearch()">
                   <i class="icon ion-ios-close placeholder-icon" style="font-size:1.4em;color:#666;"></i>
            </a>              
          </div>        
          <button class="button button-clear" ui-sref="app.postmapview">
            Map
          </button>

        <!--
        <div class="row" style="padding-top:10px;width:100%;">
            <button menu-toggle="left" class="button button-icon" style="padding-bottom:0;padding-left:0;padding-top:4px;width:40px;margin-right:10px;">
                <img src="img/menu_off.png" height="20"/>
                <p class="icon-label">Menu</p>
            </button>
            <button class="col button button-icon" ng-click="goToNewPost()" style="padding-top:4px;padding-bottom:0;margin-right:6px;">
                <img src="img/newpost_off.png" height="22"/>
                <p style="margin-left:-4px;" class="icon-label">Post</p>
            </button>
            <button class="col button button-icon" ng-click="showAlerts($event)" style="padding-top:4px;padding-bottom:0;">
                <img src="img/alerts_off.png" height="22"/>
                <span ng-if="unreadAlerts > 0" class="alert-badge">{{unreadAlerts}}</span>
                <p class="icon-label">Alerts</p>
            </button>
            <button class="col button button-icon" ng-click="toggleSearch()" style="padding-top:4px;padding-bottom:0;margin-right:-4px;">
                <img ng-show="!isFiltered" src="img/search_off.png" height="22"/>
                <img ng-show="isFiltered" src="img/search_on.png" height="22"/>
                <p class="icon-label">Search</p>
            </button>
            <button class="button button-icon" ui-sref="app.postmapview" style="width:64px;padding-right:0;padding-top:4px;padding-bottom:0;margin-right:-6px;">
              <img src="img/map_off.png" height="22"/>
                <p class="icon-label">Map View</p>
            </button>
        </div>
        -->
    </div>
  <ion-content padding="false" class="has-header" id="eventPlaceholder">
      <div ng-show="searchMode" class="list">
          <div class="item item-header item-icon-left">
              <i class="icon ion-ios-clock-outline"></i>
              RECENT SEARCHES
          </div>
          <a class="item item-light" ng-repeat="search in recentSearches" ng-click="setRecentSearch(search)" style="border:0;height:40px;">
            {{search.text}}
          </a>
      </div>      
    <ion-refresher on-refresh="doRefresh()"></ion-refresher> 
    <div class="post_item" ng-hide="post.hideCat" ng-repeat='post in nearbyPosts track by $index'>
      <div class="row user">
        <div class="col col-90"> 
            <p class="desc" ng-hide="post.truncatedNews" ng-bind-html="post.news | linky | hrefToJS | hashtag"></p>
            <p class="desc" ng-show="post.truncatedNews" ng-bind-html="post.truncatedNews | linky | hrefToJS | hashtag"></p>
            <a ng-show="post.truncatedNews" ng-click="goToComments(post)">See more ...</a>
        </div>
        <div ng-click="showMapForPost(post)" class="col col-10" style="width:40px;padding-top:2%">
            <img width="40" ng-src="img/pin{{post.category_id}}.svg" />
        </div>
      </div>
      <img ng-if="post.thumb" class="post-iamge" ng-src={{post.thumb}} ng-click="showImage(post.image)" alt="">
        <div class="item" style="padding-top:0;" ng-if="post.link_url" on-swipe="onListSwipe()" on-tap="openLink(post.link_url)">
            <div class="item-body">
              <img class="full-image" ng-src={{post.link_image}} ng-if="post.link_image" alt="">
              <div class="post-link">
                  <h3 class="link-title">{{post.link_title}}</h3>
                  <span class="link-text">{{post.link_description}}</span>
              </div>
            </div>
        </div>
      <div class="share row">
        <post-like-box></post-like-box>
        <span class="text-comm" ng-if="post.comment_count > 1" ng-click="goToComments(post)">
            {{post.comment_count}} comments
        </span>
        <span class="text-comm" ng-if="post.comment_count == 1" ng-click="goToComments(post)">
            1 comment
        </span>          
        <span class="text-comm" ng-if="post.comment_count == 0" ng-click="goToComments(post)">
            Comment
        </span>
        <div class="post-by">
            <div class="row text-gray">
                <div class="date">
                  {{post.created_date}} by 
                </div>
                <div ng-click="goToProfile(post.user_id)" class="user-name">{{post.Name}}</div>
            </div>
        </div>
        <post-actions post="post" from="list"></post-actions>
      </div>
    </div>      
      <ion-infinite-scroll ng-if="hasMore" distance="1%" on-infinite="loadMore()">
    </ion-infinite-scroll>
  </ion-content>
</ion-view>
